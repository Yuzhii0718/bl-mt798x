<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<title>Update in progress</title>
		<link rel="stylesheet" href="/style.css">
		<script src="/main.js"></script>
		<script>
			function init() {
				getversion();
				// Initial i18n texts
				document.getElementById('title').textContent = t('flashing.titleInProgress');
				document.getElementById('info').innerHTML = t('flashing.infoInProgress');

				ajax({
					url: '/result',
					done: function(response) {
						if (response == 'failed') {
							location = '/fail.html'
							return
						}

						document.getElementById('title').textContent = t('flashing.titleDone');
						document.getElementById('info').innerHTML = t('flashing.infoDone');
					},
					timeout: 1800000
				})
			}
		</script>
	</head>
	<body onload="init()">
		<div id="m"></div>
        <div id="version"></div>
	</body>
</html>
